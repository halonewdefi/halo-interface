{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useQuery, gql } from '@apollo/client';\nimport defaults from '../common/defaults';\nexport const useUniswapV2Price = function (pairAddress) {\n  _s();\n\n  let principalPrice = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let pollInterval = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaults.api.graphql.pollInterval;\n  const query = gql`\n\t\tquery {\n\t\t\tpairs (\n\t\t\t\twhere: {\n\t\t\t\t\tid: \"${String(pairAddress).toLowerCase()}\"\n\t\t\t\t}\n\t\t\t\t) {\n\t\t\t\t\ttoken0Price\n\t\t\t\t\ttoken1Price\n\t\t\t\t\t${principalPrice ? `\n\t\t\t\t\treserve0\n\t\t\t\t\treserve1\n\t\t\t\t\ttotalSupply\n\t\t\t\t\t` : ''}\n\t\t\t\t}\n\t\t}`;\n  const {\n    data,\n    error,\n    loading\n  } = useQuery(query, {\n    client: defaults.api.graphql.client.uniswapV2,\n    pollInterval: pollInterval\n  });\n\n  if (principalPrice) {\n    var _data$pairs, _data$pairs$, _data$pairs2, _data$pairs2$, _data$pairs3, _data$pairs3$, _data$pairs4, _data$pairs4$;\n\n    const tvl = Number((data === null || data === void 0 ? void 0 : (_data$pairs = data.pairs) === null || _data$pairs === void 0 ? void 0 : (_data$pairs$ = _data$pairs[0]) === null || _data$pairs$ === void 0 ? void 0 : _data$pairs$.reserve0) * (data === null || data === void 0 ? void 0 : (_data$pairs2 = data.pairs) === null || _data$pairs2 === void 0 ? void 0 : (_data$pairs2$ = _data$pairs2[0]) === null || _data$pairs2$ === void 0 ? void 0 : _data$pairs2$.token1Price)) + Number(data === null || data === void 0 ? void 0 : (_data$pairs3 = data.pairs) === null || _data$pairs3 === void 0 ? void 0 : (_data$pairs3$ = _data$pairs3[0]) === null || _data$pairs3$ === void 0 ? void 0 : _data$pairs3$.reserve1);\n    const price = Number(tvl / (data === null || data === void 0 ? void 0 : (_data$pairs4 = data.pairs) === null || _data$pairs4 === void 0 ? void 0 : (_data$pairs4$ = _data$pairs4[0]) === null || _data$pairs4$ === void 0 ? void 0 : _data$pairs4$.totalSupply));\n    return [price && tvl ? {\n      totalValueLocked: tvl,\n      principalPrice: price\n    } : undefined, loading, error];\n  }\n\n  return [data, loading, error];\n};\n\n_s(useUniswapV2Price, \"eE+cqeCo2lkI//dPlCsO1rICVGU=\", false, function () {\n  return [useQuery];\n});","map":{"version":3,"sources":["/home/augustin/vader-dapp/src/hooks/useUniswapV2Price.js"],"names":["useQuery","gql","defaults","useUniswapV2Price","pairAddress","principalPrice","pollInterval","api","graphql","query","String","toLowerCase","data","error","loading","client","uniswapV2","tvl","Number","pairs","reserve0","token1Price","reserve1","price","totalSupply","totalValueLocked","undefined"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,GAAnB,QAA8B,gBAA9B;AACA,OAAOC,QAAP,MAAqB,oBAArB;AAEA,OAAO,MAAMC,iBAAiB,GAAG,UAACC,WAAD,EAA2F;AAAA;;AAAA,MAA7EC,cAA6E,uEAA5D,KAA4D;AAAA,MAArDC,YAAqD,uEAAtCJ,QAAQ,CAACK,GAAT,CAAaC,OAAb,CAAqBF,YAAiB;AAE3H,QAAMG,KAAK,GAAGR,GAAI;AACnB;AACA;AACA;AACA,YAAYS,MAAM,CAACN,WAAD,CAAN,CAAoBO,WAApB,EAAkC;AAC9C;AACA;AACA;AACA;AACA,OAAON,cAAc,GAAI;AACzB;AACA;AACA;AACA,MAJqB,GAIZ,EAAG;AACZ;AACA,IAfC;AAiBA,QAAM;AAAEO,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA;AAAf,MAA2Bd,QAAQ,CACxCS,KADwC,EAExC;AACCM,IAAAA,MAAM,EAAEb,QAAQ,CAACK,GAAT,CAAaC,OAAb,CAAqBO,MAArB,CAA4BC,SADrC;AAEGV,IAAAA,YAAY,EAAEA;AAFjB,GAFwC,CAAzC;;AAQA,MAAGD,cAAH,EAAmB;AAAA;;AAClB,UAAMY,GAAG,GAAGC,MAAM,CAAC,CAACN,IAAD,aAACA,IAAD,sCAACA,IAAI,CAAEO,KAAP,gEAAC,YAAc,CAAd,CAAD,iDAAC,aAAkBC,QAAnB,KAAgCR,IAAhC,aAAgCA,IAAhC,uCAAgCA,IAAI,CAAEO,KAAtC,kEAAgC,aAAc,CAAd,CAAhC,kDAAgC,cAAkBE,WAAlD,CAAD,CAAN,GAAyEH,MAAM,CAACN,IAAD,aAACA,IAAD,uCAACA,IAAI,CAAEO,KAAP,kEAAC,aAAc,CAAd,CAAD,kDAAC,cAAkBG,QAAnB,CAA3F;AACA,UAAMC,KAAK,GAAGL,MAAM,CAAED,GAAD,IAASL,IAAT,aAASA,IAAT,uCAASA,IAAI,CAAEO,KAAf,kEAAS,aAAc,CAAd,CAAT,kDAAS,cAAkBK,WAA3B,CAAD,CAApB;AACA,WAAO,CAACD,KAAK,IAAIN,GAAT,GAAe;AACtBQ,MAAAA,gBAAgB,EAAER,GADI;AAEtBZ,MAAAA,cAAc,EAAEkB;AAFM,KAAf,GAGJG,SAHG,EAGQZ,OAHR,EAGiBD,KAHjB,CAAP;AAIA;;AACD,SAAO,CAACD,IAAD,EAAOE,OAAP,EAAgBD,KAAhB,CAAP;AAEA,CArCM;;GAAMV,iB;UAmBqBH,Q","sourcesContent":["import { useQuery, gql } from '@apollo/client'\nimport defaults from '../common/defaults'\n\nexport const useUniswapV2Price = (pairAddress, principalPrice = false, pollInterval = defaults.api.graphql.pollInterval) => {\n\n\tconst query = gql`\n\t\tquery {\n\t\t\tpairs (\n\t\t\t\twhere: {\n\t\t\t\t\tid: \"${String(pairAddress).toLowerCase()}\"\n\t\t\t\t}\n\t\t\t\t) {\n\t\t\t\t\ttoken0Price\n\t\t\t\t\ttoken1Price\n\t\t\t\t\t${principalPrice ? `\n\t\t\t\t\treserve0\n\t\t\t\t\treserve1\n\t\t\t\t\ttotalSupply\n\t\t\t\t\t` : ''}\n\t\t\t\t}\n\t\t}`\n\n\tconst { data, error, loading } = useQuery(\n\t\tquery,\n\t\t{\n\t\t\tclient: defaults.api.graphql.client.uniswapV2,\n   \t\tpollInterval: pollInterval,\n\t\t},\n\t)\n\n\tif(principalPrice) {\n\t\tconst tvl = Number((data?.pairs?.[0]?.reserve0) * (data?.pairs?.[0]?.token1Price)) + Number(data?.pairs?.[0]?.reserve1)\n\t\tconst price = Number((tvl) / (data?.pairs?.[0]?.totalSupply))\n\t\treturn [price && tvl ? {\n\t\t\ttotalValueLocked: tvl,\n\t\t\tprincipalPrice: price,\n\t\t} : undefined, loading, error]\n\t}\n\treturn [data, loading, error]\n\n}"]},"metadata":{},"sourceType":"module"}